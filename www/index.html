<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' gap:; style-src 'self' 'unsafe-inline'; media-src *" />

    <link rel="stylesheet" type="text/css" href="css/index.css" />
    
    <title>CPA</title>
</head>

<body>
    <div class="app">
        <div id='gag' class="hidden">No network connection</div>
        <div id='splashscreen'>Loading...</div>
        <iframe id="iframe" src="http://cpa.pixliapp.com/"></iframe>
    </div>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        var frameLoaded = false, deviceReady = false;
        var gag = document.getElementById('gag');
        var splashscreen = document.getElementById('splashscreen');
        var iframe = document.getElementById('iframe');
        iframe.onload = function() {
            frameLoaded = true
            onStateChanged()
        }

        
        function  isConnected() {
            var networkState = navigator.connection.type;
            /*var states = {};
            states[Connection.UNKNOWN]  = 'Unknown connection';
            states[Connection.ETHERNET] = 'Ethernet connection';
            states[Connection.WIFI]     = 'WiFi connection';
            states[Connection.CELL_2G]  = 'Cell 2G connection';
            states[Connection.CELL_3G]  = 'Cell 3G connection';
            states[Connection.CELL_4G]  = 'Cell 4G connection';
            states[Connection.CELL]     = 'Cell generic connection';
            states[Connection.NONE]     = 'No network connection';*/
            return navigator.connection.type !== Connection.NONE
        }
        
        document.addEventListener("offline", onStateChanged, false);
        document.addEventListener("online", onStateChanged, false);

        document.addEventListener("deviceready", function(){
          deviceReady = true;
          onStateChanged()
        },true);
        
        function onStateChanged(){
            if(deviceReady && frameLoaded){
                splashscreen.className = "hidden"
            }else{
                splashscreen.className = ""
            }
            if(isConnected()){
                gag.className = "hidden"
            }else{
                gag.className = ""
            }
        }
        document.onload = onStateChanged
    </script>
</body>
</html>
